<idea-plugin>
    <id>org.openscad.plugin</id>
    <name>OpenSCAD</name>
    <version>0.1.0</version>
    <vendor email="support@openscad.org" url="https://openscad.org">OpenSCAD Community</vendor>

    <description>
        <![CDATA[
        <h1>OpenSCAD Language Support</h1>
        <p>Full-featured IntelliJ IDEA plugin for OpenSCAD with syntax highlighting, code intelligence, and 3D preview.</p>
        
        <h2>Features</h2>
        <ul>
            <li><b>Syntax Highlighting</b> - Full OpenSCAD language support with color coding</li>
            <li><b>Code Intelligence</b> - Autocomplete, go-to-definition, find usages</li>
            <li><b>3D Preview</b> - Real-time STL preview with wireframe/solid rendering</li>
            <li><b>Split Editor</b> - Code and preview side-by-side</li>
            <li><b>Auto-render</b> - Automatic preview updates on save</li>
            <li><b>Run Configurations</b> - Custom OpenSCAD CLI configurations</li>
            <li><b>Animation Support</b> - Export animation frames using $t variable</li>
            <li><b>Batch Export</b> - Export multiple files at once (STL, PNG, etc.)</li>
            <li><b>Library Path Support</b> - Configure external library paths (OPENSCADPATH)</li>
            <li><b>Error Reporting</b> - OpenSCAD errors shown in IDE notifications</li>
            <li><b>File Templates</b> - Quick start with Empty, 3D Model, or 2D Shape templates</li>
        </ul>
        
        <h2>Requirements</h2>
        <p>OpenSCAD must be installed on your system. Download from <a href="https://openscad.org/downloads.html">openscad.org</a></p>
        
        <h2>Getting Started</h2>
        <ol>
            <li>Configure OpenSCAD path in Settings → Tools → OpenSCAD</li>
            <li>Create a new OpenSCAD file: File → New → OpenSCAD File</li>
            <li>Start coding! The preview updates automatically on save</li>
        </ol>
        ]]>
    </description>

    <depends>com.intellij.modules.platform</depends>

    <extensions defaultExtensionNs="com.intellij">
        <!-- File type -->
        <fileType name="OpenSCAD" 
                  implementationClass="org.openscad.file.OpenSCADFileType" 
                  fieldName="INSTANCE" 
                  language="OpenSCAD" 
                  extensions="scad"/>
        
        <!-- Language support -->
        <lang.parserDefinition language="OpenSCAD" implementationClass="org.openscad.parser.OpenSCADParserDefinition"/>
        <!-- Syntax highlighting -->
        <lang.syntaxHighlighterFactory language="OpenSCAD" implementationClass="org.openscad.highlighting.OpenSCADSyntaxHighlighterFactory"/>
        <annotator language="OpenSCAD" implementationClass="org.openscad.highlighting.OpenSCADAnnotator"/>
        <colorSettingsPage implementation="org.openscad.highlighting.OpenSCADColorSettingsPage"/>
        <lang.commenter language="OpenSCAD" implementationClass="org.openscad.commenter.OpenSCADCommenter"/>
        
        <!-- Code intelligence -->
        <completion.contributor language="OpenSCAD" implementationClass="org.openscad.completion.OpenSCADCompletionContributor"/>
        <lang.psiStructureViewFactory language="OpenSCAD" implementationClass="org.openscad.structure.OpenSCADStructureViewFactory"/>
        <psi.referenceContributor language="OpenSCAD" implementation="org.openscad.references.OpenSCADReferenceContributor"/>
        <lang.findUsagesProvider language="OpenSCAD" implementationClass="org.openscad.findusages.OpenSCADFindUsagesProvider"/>
        <lang.documentationProvider language="OpenSCAD" implementationClass="org.openscad.documentation.OpenSCADDocumentationProvider"/>
        
        <!-- Editor features -->
        <lang.braceMatcher language="OpenSCAD" implementationClass="org.openscad.editor.OpenSCADBraceMatcher"/>
        <lang.foldingBuilder language="OpenSCAD" implementationClass="org.openscad.editor.OpenSCADFoldingBuilder"/>
        <fileEditorProvider implementation="org.openscad.editor.OpenSCADSplitEditorProvider"/>
        
        <!-- Preview tool window -->
        <toolWindow id="OpenSCAD Preview" 
                    anchor="right" 
                    icon="/icons/openscad.svg"
                    factoryClass="org.openscad.preview.OpenSCADPreviewToolWindowFactory"/>
        
        <!-- Settings -->
        <projectConfigurable parentId="tools" 
                           instance="org.openscad.settings.OpenSCADSettingsConfigurable"
                           id="org.openscad.settings.OpenSCADSettingsConfigurable"
                           displayName="OpenSCAD"/>
        <projectService serviceImplementation="org.openscad.settings.OpenSCADSettings"/>
        
        <!-- Notifications -->
        <notificationGroup id="OpenSCAD" displayType="BALLOON" isLogByDefault="true"/>
        
        <!-- Run Configuration -->
        <configurationType implementation="org.openscad.run.OpenSCADConfigurationType"/>
    </extensions>

    <actions>
        <!-- New file action -->
        <action id="OpenSCAD.NewFile"
                class="org.openscad.actions.NewOpenSCADFileAction"
                text="OpenSCAD File"
                description="Create new OpenSCAD file">
            <add-to-group group-id="NewGroup" anchor="before" relative-to-action="NewFile"/>
        </action>
        
        <!-- Context menu action for showing documentation -->
        <action id="OpenSCAD.ShowDocumentation" 
                class="org.openscad.actions.ShowDocumentationAction" 
                text="Show OpenSCAD Documentation" 
                description="Show documentation for the OpenSCAD symbol at caret">
            <add-to-group group-id="EditorPopupMenu" anchor="first"/>
            <keyboard-shortcut keymap="$default" first-keystroke="ctrl shift D"/>
        </action>
        
        <!-- Export actions -->
        <action id="OpenSCAD.ExportSTL"
                class="org.openscad.actions.ExportSTLAction"
                text="Export to STL..."
                description="Export OpenSCAD file to STL format">
            <add-to-group group-id="ProjectViewPopupMenu" anchor="last"/>
            <add-to-group group-id="EditorPopupMenu" anchor="last"/>
        </action>
        
        <action id="OpenSCAD.BatchExport"
                class="org.openscad.actions.BatchExportAction"
                text="Batch Export to STL..."
                description="Export all OpenSCAD files in project to STL">
            <add-to-group group-id="ToolsMenu" anchor="last"/>
        </action>
        
        <action id="OpenSCAD.ExportMultiFormat"
                class="org.openscad.actions.ExportMultiFormatAction"
                text="Export to Multiple Formats..."
                description="Export to STL, PNG, and other formats">
            <add-to-group group-id="ProjectViewPopupMenu" anchor="last"/>
            <add-to-group group-id="EditorPopupMenu" anchor="last"/>
        </action>
    </actions>
</idea-plugin>
